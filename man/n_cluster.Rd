% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/n_cluster.R
\name{n_cluster}
\alias{n_cluster}
\title{Optimal Multistage Cluster Allocation}
\usage{
n_cluster(cost, delta, rel_var = 1, k = 1, cv = NULL, budget = NULL, m = NULL)
}
\arguments{
\item{cost}{Numeric vector of per-stage costs. Length determines the
number of stages (2 or 3).}

\item{delta}{Numeric vector of homogeneity measures (length = stages - 1),
or a \code{svyplan_varcomp} object.}

\item{rel_var}{Unit relvariance (default 1).}

\item{k}{Ratio parameter(s). Scalar for 2-stage, length-2 vector for
3-stage (default 1).}

\item{cv}{Target coefficient of variation. Specify exactly one of \code{cv}
or \code{budget}.}

\item{budget}{Total budget. Specify exactly one of \code{cv} or \code{budget}.}

\item{m}{Fixed stage-1 sample size. \code{NULL} (default) means optimize all
stages.}
}
\value{
A \code{svyplan_cluster} object.
}
\description{
Compute optimal per-stage sample sizes for a multistage cluster
design, minimizing cost for a given precision or minimizing
variance for a given budget.
}
\details{
Stage count is determined by \code{length(cost)}. Two dispatch dimensions:
\itemize{
\item \strong{2-stage vs 3-stage} (vector length)
\item \strong{budget vs cv} mode (which is non-NULL)
}

When \code{m} is specified, stage 1 is fixed and only stage 2+ are optimized.

If \code{delta} is a \code{svyplan_varcomp} object, \code{delta}, \code{rel_var}, and \code{k}
are extracted automatically.
}
\examples{
# 2-stage, budget mode
n_cluster(cost = c(500, 50), delta = 0.05, budget = 100000)

# 2-stage, CV mode
n_cluster(cost = c(500, 50), delta = 0.05, cv = 0.05)

# 2-stage, fixed m
n_cluster(cost = c(500, 50), delta = 0.05, budget = 100000, m = 40)

# 3-stage
n_cluster(cost = c(500, 100, 50), delta = c(0.01, 0.05), cv = 0.05)

}
\references{
Valliant, R., Dever, J. A., and Kreuter, F. (2018).
\emph{Practical Tools for Designing and Weighting Survey Samples}
(2nd ed.). Springer. Ch. 9.
}
\seealso{
\code{\link[=cv_cluster]{cv_cluster()}} for the inverse, \code{\link[=varcomp]{varcomp()}} for estimating
variance components.
}
