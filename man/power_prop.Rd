% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/power_prop.R
\name{power_prop}
\alias{power_prop}
\title{Power Analysis for Proportions}
\usage{
power_prop(
  p1,
  p2 = NULL,
  n = NULL,
  power = 0.8,
  alpha = 0.05,
  N = Inf,
  deff = 1,
  resp_rate = 1,
  sides = 2,
  overlap = 0,
  rho = 0
)
}
\arguments{
\item{p1}{Baseline proportion, in (0, 1).}

\item{p2}{Alternative proportion, in (0, 1). Leave \code{NULL} to solve for MDE.}

\item{n}{Per-group sample size. Leave \code{NULL} to solve for sample size.}

\item{power}{Target power, in (0, 1). Leave \code{NULL} to solve for power.}

\item{alpha}{Significance level, default 0.05.}

\item{N}{Per-group population size. \code{Inf} (default) means no finite
population correction.}

\item{deff}{Design effect multiplier (> 0). Values < 1 are valid for
efficient designs (e.g., stratified sampling with Neyman allocation).}

\item{resp_rate}{Expected response rate, in (0, 1]. Default 1 (no
adjustment). The sample size is inflated by \code{1 / resp_rate}.}

\item{sides}{\code{1} for one-sided or \code{2} (default) for two-sided test.}

\item{overlap}{Panel overlap fraction in [0, 1], for repeated surveys.}

\item{rho}{Correlation between occasions in [0, 1].}
}
\value{
A \code{svyplan_power} object with components:
\describe{
\item{\code{n}}{Per-group sample size.}
\item{\code{power}}{Achieved power.}
\item{\code{delta}}{Difference in proportions (\code{p2 - p1}).}
\item{\code{solved}}{Which quantity was solved for
(\code{"n"}, \code{"power"}, or \code{"mde"}).}
\item{\code{params}}{List of input parameters.}
}
}
\description{
Compute sample size, power, or minimum detectable effect (MDE) for a
two-sample test of proportions. Leave exactly one of \code{n}, \code{power}, or
\code{p2} as \code{NULL} to solve for that quantity.
}
\details{
The effective variance for the difference in proportions is:

\deqn{V = p_1(1-p_1) + p_2(1-p_2) - 2 \cdot \text{overlap} \cdot \rho
  \sqrt{p_1(1-p_1) \cdot p_2(1-p_2)}}

The panel overlap term reduces the variance when the same units are
observed at both occasions, following the approach in Kish (1965, Ch. 11).
\itemize{
\item \strong{Solve n}: \eqn{n_0 = (z_{\alpha/s} + z_\beta)^2 \cdot V \cdot
  \text{deff} / \delta^2}, then finite population correction.
\item \strong{Solve power}: Compute SE, then
\eqn{\text{power} = \Phi(\delta / \text{SE} - z_{\alpha/s})}.
For two-sided tests both tails are included.
\item \strong{Solve MDE}: \code{uniroot} search for the smallest \code{p2 > p1} achieving
the target power. To find the MDE for a decrease, swap \code{p1} and \code{p2}.
}
}
\examples{
# Sample size to detect a 5pp change from 30\%
power_prop(p1 = 0.30, p2 = 0.35)

# Power given n = 500
power_prop(p1 = 0.30, p2 = 0.35, n = 500, power = NULL)

# MDE with n = 1000
power_prop(p1 = 0.30, n = 1000)

# With design effect
power_prop(p1 = 0.30, p2 = 0.35, deff = 1.5)

# Panel survey with 50\% overlap
power_prop(p1 = 0.30, p2 = 0.35, overlap = 0.5, rho = 0.6)

}
\references{
Cochran, W. G. (1977). \emph{Sampling Techniques} (3rd ed.). Wiley.

Kish, L. (1965). \emph{Survey Sampling}. Wiley.
}
\seealso{
\code{\link[=power_mean]{power_mean()}} for continuous outcomes, \code{\link[=n_prop]{n_prop()}} for
estimation precision.
}
